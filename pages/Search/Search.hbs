<main class=search-page id=main>

  <search class=sticky>
    <form class=search-form method=get>
      <label for=search-box>Quick Search</label>
      <div class=search-controls>
        <input
          autocomplete=on
          autocorrect=off
          class=text-box
          enterkeyhint=search
          id=search-box
          inputmode=search
          name=q
          placeholder='e.g. “atimw-” or “dog”'
          spellcheck=false
          type=search
        >
        <button class='button green' type=submit>Search</button>
      </div>
      <span class=help-text>Searches forms (in any orthography) and definitions for a match anywhere within the string. Search is not case sensitive. Leave blank and press "Search" to display all components.</span>
    </form>
  </search>

  {{#unless hasResults }}
    <dl class='stats sticky'>
      <dt># of languages</dt>
      <dd>{{ numLanguages }}</dd>
      <dt># of components</dt>
      <dd>{{ numComponents }}</dd>
    </dl>
  {{else}}
    {{#unless results }}
      <p class='no-results sticky'>No results found.</p>
    {{else}}

      <div class='results-info sticky'>
        <p class=num-results>Showing results {{ pagination.startIndex }}–{{ pagination.endIndex }} of {{ totalResults }}.</p>
        <p class=help-text>Click on a column header to sort that column.</p>
        <p class=help-text>Click on a form in the table below to view more information about that component.</p>
        {{> em-dash/em-dash }}
      </div>

      {{#if pagination.show }}
        {{> Search/components/pagination/pagination }}
      {{/if}}

      <div aria-labelledby=results-caption class='results-wrapper scroll-shadow' role=region tabindex=0>

        <span id=sort-hint>Click on a header column to sort.</span>

        <table id=results>
          <caption class=visually-hidden id=results-caption><h2>Search Results</h2></caption>
          <thead>
            <tr class=meta-row>
              {{!-- Component Fields --}}
              <th class='c partial-width-bb' colspan=7 scope=col>
                <span>Components</span><br><span class='help-text th-note'>(Project Orthography)</span>
              </th>
              {{!-- Token Fields --}}
              <th class='c partial-width-bb' colspan=5 scope=col>
                <span>Sources</span><br><span class='help-text th-note'>(Original Orthographies)</span>
              </th>
            </tr>
            <tr>

              {{!-- Component Fields --}}
              {{#with sort }}
              <th {{#if displayLanguage }} aria-sort='{{ displayLanguage }}' {{/if}} scope=col>
                <button aria-describedby=sort-hint class=sort-button data-field=displayLanguage>
                  <span>Language</span>
                  <svg aria-hidden class=sort-icon><use href='{{#if (is displayLanguage 'ascending') }}#ascending{{else if (is displayLanguage 'descending') }}#descending{{else}}#sort{{/if}}'></svg>
                </button>
              </th>
              <th {{#if form }} aria-sort='{{ form }}' {{/if}} scope=col>
                <button aria-describedby=sort-hint class=sort-button data-field=form>
                  <span>Form</span>
                  <svg aria-hidden class=sort-icon><use href='{{#if (is form 'ascending') }}#ascending{{else if (is form 'descending') }}#descending{{else}}#sort{{/if}}'></svg>
                </button>
              </th>
              <th {{#if UR }} aria-sort='{{ UR }}' {{/if}} scope=col>
                <button aria-describedby=sort-hint class=sort-button data-field=UR>
                  <span>UR</span>
                  <svg aria-hidden class=sort-icon><use href='{{#if (is UR 'ascending') }}#ascending{{else if (is UR 'descending') }}#descending{{else}}#sort{{/if}}'></svg>
                </button>
              </th>
              <th {{#if PA }} aria-sort='{{ PA }}' {{/if}} scope=col>
                <button aria-describedby=sort-hint class=sort-button data-field=PA>
                  <span>Proto-Algonquian</span>
                  <svg aria-hidden class=sort-icon><use href='{{#if (is PA 'ascending') }}#ascending{{else if (is PA 'descending') }}#descending{{else}}#sort{{/if}}'></svg>
                </button>
              </th>
              <th {{#if definition }} aria-sort='{{ definition }}' {{/if}} scope=col>
                <button aria-describedby=sort-hint class=sort-button data-field=definition>
                  <span>Definition</span>
                  <svg aria-hidden class=sort-icon><use href='{{#if (is definition 'ascending') }}#ascending{{else if (is definition 'descending') }}#descending{{else}}#sort{{/if}}'></svg>
                </button>
              </th>
              <th {{#if type }} aria-sort='{{ type }}' {{/if}} scope=col>
                <button aria-describedby=sort-hint class=sort-button data-field=type>
                  <span>Type</span>
                  <svg aria-hidden class=sort-icon><use href='{{#if (is type 'ascending') }}#ascending{{else if (is type 'descending') }}#descending{{else}}#sort{{/if}}'></svg>
                </button>
              </th>
              <th {{#if subcategory }} aria-sort='{{ subcategory }}' {{/if}} scope=col>
                <button aria-describedby=sort-hint class=sort-button data-field=subcategory>
                  <span>Subcategory</span>
                  <svg aria-hidden class=sort-icon><use href='{{#if (is subcategory 'ascending') }}#ascending{{else if (is subcategory 'descending') }}#descending{{else}}#sort{{/if}}'></svg>
                </button>
              </th>
              {{/with}}

              {{!-- Token Fields --}}
              <th class=token-th scope=col>Forms</th>
              <th class=token-th scope=col>URs</th>
              <th class=token-th scope=col>Proto-Algonquian</th>
              <th class=token-th scope=col>Glosses</th>
              <th class=token-th scope=col>Bibliography</th>

            </tr>
          </thead>
          <tbody>
            {{#each results as |result| }}
              <tr>
                <td class=language>{{ displayLanguage }}</td>
                <td class=form>{{#if form }}<a class=link href='/components/{{ ID }}'>{{ form }}</a>{{else}}—{{/if}}</td>
                <td class=UR>{{#if UR }}<a class=link href='/components/{{ ID }}'>/{{ UR }}/</a>{{else}}—{{/if}}</td>
                <td class=PA>{{#if PA }}{{ PA }}{{else}}—{{/if}}</td>
                <td class=definition>{{#if definition }}‘{{ definition }}’{{else}}—{{/if}}</td>
                <td class=component-type>{{#if type }}{{ type }}{{else}}—{{/if}}</td>
                <td class=subcategory>{{#if subcategory }}{{ subcategory }}{{else}}—{{/if}}</td>
                <td class=source-forms>
                  <ul>
                    {{#each tokens as |token| }}
                      <li>{{#if form }}{{ form }}{{else}}—{{/if}}</li>
                    {{/each}}
                  </ul>
                </td>
                <td class=source-URs>
                  <ul>
                    {{#each tokens as |token| }}
                      <li>{{#if UR }}/{{ UR }}/{{else}}—{{/if}}</li>
                    {{/each}}
                  </ul>
                </td>
                <td class=source-PA>
                  <ul>
                    {{#each tokens as |token| }}
                      <li>{{#if PA }}{{ PA }}{{else}}—{{/if}}</li>
                    {{/each}}
                  </ul>
                </td>
                <td class=source-glosses>
                  <ul>
                    {{#each tokens as |token| }}
                      <li>{{#if gloss }}‘{{ gloss }}’{{else}}—{{/if}}</li>
                    {{/each}}
                  </ul>
                </td>
                <td class=bibliography>
                  <ul>
                    {{#each tokens as |token| }}
                      <li>{{#if bibliography }}{{ bibliography }}{{else}}—{{/if}}</li>
                    {{/each}}
                  </ul>
                </td>
              </tr>
            {{/each}}
          </tbody>
        </table>
      </div>

      {{#if pagination.show }}
        {{> Search/components/pagination/pagination }}
      {{/if}}

      <section class='citation sticky'>

        <h2>How to Cite these Results</h2>

        <blockquote class=blockquote data-hook=citation><p>Monica Macaulay, Hunter T. Lockwood, &amp; Daniel W. Hieber. {{ meta.releaseYear }}. <cite>Nisinoon: The Algonquian Components Database</cite> v{{ package.version}}. DOI: <a class=link href=https://doi.org/10.5281/zenodo.11459862>10.5281/zenodo.11459862</a>. URL: <a class=link href='https://nisinoon.net{{ url }}'>https://nisinoon.net{{ url }}</a>.</p></blockquote>

        <button class='button copy-button' data-hook=copy-citation type=button>Copy</button>

      </section>

    {{/unless}}
  {{/unless}}

</main>

{{#section 'scripts'}}
  <script async type=module>{{{ js.Search }}}</script>
{{/section}}